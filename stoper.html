<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>BsAdstoper</title> <link rel="icon" type="image/x-icon" href="https://i.ibb.co/DgWHFgR/roralogo.png"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald|Noto+Sans"> <link rel="stylesheet" href="css.css"> <link rel="stylesheet" href="css2.css"> </head> <body> <img id="menuIcon" src="https://twice.jype.com/Content/Pc/images/common/menu.png" alt="Menu Icon" width="30" height="30"> <div id="menu"> <a href="https://blackswan19.github.io/bscrop/watchin/mylist.html">Save the video?</a><br><br> <a href="addhome.html">Add to home screen?</a><br><br> <a href="savelink.html">Save the link?</a><br><br> <a href="howtodo.mp4">Help?</a> </div> <script> document.getElementById("menuIcon").addEventListener("click", function() { var menu = document.getElementById("menu"); menu.style.display = menu.style.display === "block" ? "none" : "block"; }); </script> <script src="noright.js"></script> <div class="side-section"> <a id="showButton" onclick="showRecommendations()" style="text-decoration: none;"> <i class="fa-solid fa-clock-rotate-left"></i> History</a> </div> <div class="container"> <h2>BsAdstoper</h2> <input type="text" id="userLink" placeholder="Paste any youtube link here..." autocomplete="off"> <br> <button onclick="modifyLink()">Submit</button> <div id="result"></div> </div> <div class="recommendation-section" id="recommendationSection"> <button class="close-button" onclick="closeRecommendations()">Ã—</button> <h3 style="font-size: 30px;"> History</h3> <ul class="video-list" id="videoList"></ul> <p class="small-note">NOTE: Videos in "History" are pinned by default. Unpin videos to allow removal if desired.</p> </div> <div class="notification" id="notificationBox">Link copied to clipboard!</div> <p>Note : To play videos from a YouTube playlist, the playlist must be set to public.</p>
    <script>
        // Function to store and retrieve recently watched videos
        const localStorageKey = 'recentlyWatched';

        function getRecentlyWatched() {
            const videos = localStorage.getItem(localStorageKey);
            let parsedVideos = videos ? JSON.parse(videos) : [];
            
            // Retroactively pin all existing videos
            parsedVideos = parsedVideos.map(video => ({
                ...video,
                isPinned: true // Pin all videos by default
            }));
            
            localStorage.setItem(localStorageKey, JSON.stringify(parsedVideos));
            return parsedVideos;
        }

        function addRecentlyWatched(videoUrl) {
            const videos = getRecentlyWatched();
            if (!videos.some(video => video.url === videoUrl)) {
                videos.unshift({
                    url: videoUrl,
                    isPinned: true, // Pin new videos by default
                    timestamp: Date.now() // Store current timestamp
                });
                if (videos.length > 10) videos.pop(); // Limit to 10 videos
                localStorage.setItem(localStorageKey, JSON.stringify(videos));
            }
        }

        // Function to toggle pinned state
        function togglePinned(videoUrl) {
            const videos = getRecentlyWatched();
            const video = videos.find(v => v.url === videoUrl);
            if (video) {
                video.isPinned = !video.isPinned;
                localStorage.setItem(localStorageKey, JSON.stringify(videos));
                showNotification(video.isPinned ? "Pinned!" : "Unpinned!");
                showRecommendations(); // Refresh the list
            }
        }

        // Function to display recently watched videos
        function showRecommendations() {
            const recommendationSection = document.getElementById('recommendationSection');
            const videoList = document.getElementById('videoList');
            const videos = getRecentlyWatched();

            videoList.innerHTML = ''; // Clear previous list

            if (videos.length === 0) {
                videoList.innerHTML = '<li>No videos watched recently.</li>';
            } else {
                videos.forEach(video => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <a href="${video.url}" target="_self">#BS//${video.url}//Adstoper</a>
                        <div class="action-buttons">
                            <i class="fa-solid ${video.isPinned ? 'fa-toggle-on' : 'fa-toggle-off'}" 
                               onclick="togglePinned('${video.url}')" 
                               style="cursor: pointer; margin-right: 10px;"></i>
                            <button onclick="copyToClipboard('${video.url}')">Copy</button>
                            <button onclick="deleteVideo('${video.url}')">Remove</button>
                        </div>
                    `;
                    videoList.appendChild(li);
                });
            }

            recommendationSection.style.display = 'block'; // Show the section
        }

        function closeRecommendations() {
            const recommendationSection = document.getElementById('recommendationSection');
            recommendationSection.style.display = 'none'; // Hide the section
        }

        function modifyLink() {
            const userLink = document.getElementById("userLink").value.trim();
            let modifiedLink = userLink;

            if (userLink.toLowerCase().includes("youtu.be")) {
                modifiedLink = `https://www.yout-ube.com/watch?v=${userLink.split("youtu.be/")[1].split("?")[0]}`;
            } else if (userLink.toLowerCase().includes("youtube.com")) {
                modifiedLink = userLink.replace(/youtube/i, "yout-ube");
            }

            if (modifiedLink.includes("yout-ube.com/watch?v=")) {
                document.getElementById("result").innerHTML = `
                    <button id="playButton" onclick="playVideo('${modifiedLink}')">Play in full screen</button>
                `;
                addRecentlyWatched(modifiedLink); // Store the link in local storage
                document.getElementById("userLink").value = "";
            } else {
                document.getElementById("result").innerHTML = "Invalid URL";
            }
        }

        function playVideo(videoUrl) {
            window.open(videoUrl, "_self");
        }

        function copyToClipboard(link) {
            navigator.clipboard.writeText(link).then(() => {
                showNotification("Link copied to clipboard!");
            }).catch(() => {
                showNotification("Failed to copy the link!");
            });
        }

        function deleteVideo(videoUrl) {
            let videos = getRecentlyWatched();
            videos = videos.filter(video => video.url !== videoUrl); // Remove the selected video
            localStorage.setItem(localStorageKey, JSON.stringify(videos));
            showRecommendations(); // Refresh the list
        }

        function showNotification(message) {
            const notificationBox = document.getElementById("notificationBox");
            notificationBox.textContent = message;
            notificationBox.classList.add("show");
            setTimeout(() => {
                notificationBox.classList.remove("show");
            }, 2000);
        }
    </script>
</body>
</html>
